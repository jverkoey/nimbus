<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nimbus: Table Cell Factory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24278774-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
<div id="page">
<div style="position:relative">
<div id="top"><!-- do not remove this div! -->

<div id="titlearea">
<a style="float: right;margin-right:20px;margin-top:20px" href='http://www.pledgie.com/campaigns/15519'><img alt='Click here to support Nimbus development and make a donation at www.pledgie.com !' src='http://www.pledgie.com/campaigns/15519.png?skin_name=chrome' border='0' /></a>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nimbus
   &#160;<span id="projectnumber">0.8.0 - <a href="http://github.com/jverkoey/nimbus">Nimbus is proudly hosted on Github</a></span>
   </div>
   <div id="projectbrief">An iOS framework whose growth is bounded by O(documentation).</div>
  </td>
  
  
  
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.4-20110629 -->
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group___table_cell_factory.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Table Cell Factory</div>  </div>
<div class="ingroups"><a class="el" href="group___nimbus_models.html">Nimbus Models</a></div></div>
<div class="contents">
<hr/><a name="details" id="details"></a><h2>Overview</h2>
<p>A table cell factory automatically creates UITableViewCells from objects. </p>
<p>The <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> table cell factory works by requiring that objects implement a basic protocol, <a class="el" href="protocol_n_i_cell_object-p.html" title="The protocol for an object that can be used in the NICellFactory.">NICellObject</a>, which sets up a binding from the object to a specific cell implementation. This cell implementation can optionally implement the <a class="el" href="protocol_n_i_cell-p.html" title="The protocol for a cell created in the NICellFactory.">NICell</a> protocol. In practice this is nearly always the case. You then simply use the factory in your table's data source and the factory will handle the rest. This allows you to completely separate presentation from data in your table view controllers.</p>
<h2>A Simple Example: A Twitter Application</h2>
<p>Let's say you want to build a Twitter news feed. We'll assume you've already figured out the network requests and now have individual tweets itching to be displayed. To use the <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> factory you will need two different classes: one for the tweet object and its data, and another for the tweet table view cell. Let's call them Tweet and TweetCell, respectively. You may even already have a Tweet object.</p>
<h3>Implement the <a class="el" href="protocol_n_i_cell_object-p.html" title="The protocol for an object that can be used in the NICellFactory.">NICellObject</a> Protocol</h3>
<p>You must first implement the <a class="el" href="protocol_n_i_cell_object-p.html" title="The protocol for an object that can be used in the NICellFactory.">NICellObject</a> protocol in your Tweet object. We want to link the TweetCell table view cell to the Tweet object so that the factory can create a TweetCell when it needs to present the Tweet object.</p>
<div class="fragment"><pre class="fragment"><span class="keyword">@interface </span>Tweet : NSObject &lt;<a class="code" href="protocol_n_i_cell_object-p.html" title="The protocol for an object that can be used in the NICellFactory.">NICellObject</a>&gt; {
<span class="comment">// ...</span>
}
<span class="keyword">@end</span>

<span class="keyword">@implementation </span>Tweet

- (Class)cellClass {
  <span class="keywordflow">return</span> [TweetCell class];
}

<span class="keyword">@end</span>
</pre></div><p>Now that we've pointed the Tweet object to the TweetCell class, let's make the table controller use the <a class="el" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a>.</p>
<h3>Using the Factory</h3>
<p>There are a few ways you can use the factory in your code. We'll walk through increasingly Nimbus-like implementations, starting with a vanilla UIKit implementation.</p>
<p>The following vanilla UIKit implementation has the advantage of allowing you to use <a class="el" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a> in your existing code base without requiring a full rewrite of your data source. If you are attempting to switch to a pure <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> implementation using the cell factory then this is a good first step because it is the least invasive.</p>
<div class="fragment"><pre class="fragment">- (UITableViewCell *)tableView: (UITableView *)tableView
         cellForRowAtIndexPath: (NSIndexPath *)indexPath {
  <span class="comment">// Note: You must fetch the object at this index path somehow. The objectAtIndexPath:</span>
  <span class="comment">// is simply an example; replace it with your own implementation.</span>
  <span class="keywordtype">id</span> <span class="keywordtype">object</span> = [<span class="keyword">self</span> objectAtIndexPath:indexPath];

  UITableViewCell* cell = [<a class="code" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a> tableViewModel:nil cellForTableView:tableView atIndexPath:indexPath withObject:object];
  <span class="keywordflow">if</span> (nil == cell) {
    <span class="comment">// Here would be whatever code you were originally using to create cells. nil is only returned</span>
    <span class="comment">// when the factory wasn&#39;t able to create a cell, likely due to the NICellObject protocol</span>
    <span class="comment">// not being implemented for the given object. As you implement these protocols on</span>
    <span class="comment">// more objects the factory will automatically start returning the correct cells</span>
    <span class="comment">// and you can start removing this special-case logic.</span>
  }
  <span class="keywordflow">return</span> cell;
}
</pre></div><p>This next implementation is what your vanilla data source implementation would look like once you have no more custom cell creation code.</p>
<div class="fragment"><pre class="fragment">- (UITableViewCell *)tableView: (UITableView *)tableView
         cellForRowAtIndexPath: (NSIndexPath *)indexPath {
  <span class="comment">// Note: You must fetch the object at this index path somehow. The objectAtIndexPath:</span>
  <span class="comment">// is simply an example; replace it with your own implementation.</span>
  <span class="keywordtype">id</span> <span class="keywordtype">object</span> = [<span class="keyword">self</span> objectAtIndexPath:indexPath];

  <span class="comment">// Only use the factory to create cells now that every object used in this controller</span>
  <span class="comment">// implements the factory protocols.</span>
  <span class="keywordflow">return</span> [<a class="code" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a> tableViewModel:nil cellForTableView:tableView atIndexPath:indexPath withObject:object];
}
</pre></div><p>If you are using <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> models then your code gets even simpler because the object is passed to your model delegate method.</p>
<div class="fragment"><pre class="fragment">- (UITableViewCell *)tableViewModel: (<a class="code" href="class_n_i_table_view_model.html" title="A non-mutable table view model that complies to the UITableViewDataSource protocol.">NITableViewModel</a> *)tableViewModel
                   cellForTableView: (UITableView *)tableView
                        atIndexPath: (NSIndexPath *)indexPath
                         withObject: (id)<span class="keywordtype">object</span> {
  <span class="comment">// The model gives us the object, making this much simpler and likely more efficient than the vanilla UIKit implementation.</span>
  <span class="keywordflow">return</span> [<a class="code" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a> tableViewModel:tableViewModel cellForTableView:tableView atIndexPath:indexPath withObject:object];
}
</pre></div><p>And finally, if you require no custom code in your model delegate, the above example can be shortened to a one-liner when you initialize the model:</p>
<div class="fragment"><pre class="fragment"><span class="comment">// This is functionally identical to implementing the delegate in this controller and simply</span>
<span class="comment">// calling the factory method.</span>
_model.delegate = (id)[<a class="code" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a> <span class="keyword">class</span>];
</pre></div><h3>Customizing the Cell</h3>
<p>We want to customize the cells as they are presented, otherwise all of the cells will look the same. After our TweetCell object is created in the factory, the factory will call the <a class="el" href="protocol_n_i_cell-p.html#af12eab4c2d2d97f512a373a30d230a98">shouldUpdateCellWithObject:</a> method on the cell, if it is implemented. Remember that cells are reused in table views and that any modification you may make to the cell could still be present the next time this cell is updated with an object.</p>
<div class="fragment"><pre class="fragment">- (BOOL)shouldUpdateCellWithObject:(<span class="keywordtype">id</span>)<span class="keywordtype">object</span> {
  <span class="comment">// We can be rest assured that `object` is a Tweet object because that&#39;s how we set up</span>
  <span class="comment">// the bindings. If more than one type of object maps to this cell class then we&#39;d have</span>
  <span class="comment">// to check the object type accordingly.</span>
  Tweet* tweet = object;
  <span class="keyword">self</span>.textLabel.text = tweet.text;

  <span class="comment">// Returning YES or NO here is intended purely for subclassing purposes. Returning YES means</span>
  <span class="comment">// that the object changed the cell in some way.</span>
  <span class="keywordflow">return</span> YES;
}
</pre></div><h3>Conclusions</h3>
<p>The <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> cell factory can greatly reduce the amount of code you have to write in your table controllers while separating the data from the presentation. You can slowly ease yourself into using the factory if you already have a large existing code base.</p>
<p>If you are migrating from Three20, you will find that Nimbus' table factory is very similar to TTTableViewController, though greatly simplified and decoupled from the rest of the Three20 ecosystem. Where Three20 provided a tightly integrated solution, <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> allows you to plug in the factory where it makes sense. </p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_n_i_cell_factory.html">NICellFactory</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple factory for creating table view cells from objects.  <a href="interface_n_i_cell_factory.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">protocol &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol_n_i_cell_object-p.html">&lt;NICellObject&gt;</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The protocol for an object that can be used in the <a class="el" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a>.  <a href="protocol_n_i_cell_object-p.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">protocol &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol_n_i_cell-p.html">&lt;NICell&gt;</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The protocol for a cell created in the <a class="el" href="interface_n_i_cell_factory.html" title="A simple factory for creating table view cells from objects.">NICellFactory</a>.  <a href="protocol_n_i_cell-p.html#details">More...</a><br/></td></tr>
</table>
<div id="disqus_thread"></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
</div><!-- .fixedwidth -->

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'nimbusdocumentation'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>


    <span class="footer">Generated for Nimbus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4-20110629 </span>
   </ul>
 </div>


</div> <!-- page -->
</body>
</html>
